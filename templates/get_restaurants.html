{% extends "base.html" %}
{% block content %}

<!-- search bar -->



<!-- list of restaurants -->

<div class="row">
    {% for restaurant in restaurants %}
    <div class="col s12 m6">
        <div class="card sticky-action restaurant-card">
            <div class="card-content">
                <div class="card-title grey-text text-darken-4">{{ restaurant.name }}
                    <!-- add links to social if they exist, otherwise add greyed out icon -->
                    <span class="social-links">
                        {% if restaurant.website %}
                        <a href="{{ restaurant.website }}" target="_blank"><i
                                class="fas fa-globe deep-orange-text text-accent-4"></i></a>
                        {% else %}
                        <i class="fas fa-globe greyed-out"></i>
                        {% endif %}
                        {% if restaurant.fb_page %}
                        <a href="{{ restaurant.fb_page }}" target="_blank"><i
                                class="fab fa-facebook deep-orange-text text-accent-4"></i></a>
                        {% else %}
                        <i class="fab fa-facebook greyed-out"></i>
                        {% endif %}
                        {% if restaurant.ig_page %}
                        <a href="{{ restaurant.ig_page }}" target="_blank"><i
                                class="fab fa-instagram deep-orange-text text-accent-4"></i></a>
                        {% else %}
                        <i class="fab fa-instagram greyed-out"></i>
                        {% endif %}
                    </span>
                </div>
                {% for i in range(1, restaurant.pricing_score|int) %}
                <i class="fas fa-euro-sign"></i>
                {% endfor %}
                </span>
                <div class="row">
                    <div class="col s12 m6">
                        <h5><i class="fas fa-map-marker-alt prefix"></i> {{ restaurant.address_street }}</h5>
                        <p>{{ restaurant.address_city }}</p>
                        <p>Co. {{ restaurant.address_county|capitalize }}</p>
                        <p><i class="fas fa-phone-alt"></i> {{ restaurant.tel }}</p>
                        <p><i class="fas fa-at"></i> {{ restaurant.email_address }}</p>
                    </div>
                    <div class="col s12 m6">
                        <!-- placeholder for vegan and gluten free icons-->
                    </div>
                </div>
                <a class="waves-effect waves-light btn activator">Read some reviews</a>
                {% if role == "admin" %}
                <a href="{{ url_for('edit_restaurant', restaurant_id=restaurant._id) }}"
                    class="btn light-blue lighten-1">Edit</a>
                <!-- Modal Trigger -->
                <a class="waves-effect waves-light btn modal-trigger red" href="#delete_modal_{{ restaurant._id }}">Delete</a>

                <!-- Modal Structure -->
                <div id="delete_modal_{{ restaurant._id }}" class="modal">
                    <div class="modal-content">
                        <h4>Are you sure?</h4>
                        <p>This action can't be undone!</p>
                    </div>
                    <div class="modal-footer">
                        <a href="#" class="btn modal-close lighten-1">OK, let's leave it</a>
                        <a href="{{ url_for('delete_restaurant', restaurant_id=restaurant._id) }}"
                            class="btn red lighten-1">Delete</a>
                    </div>
                </div>


                {% endif %}
                {% for i in range(1, restaurant.avg_star_score|int) %}
                <i class="fas fa-star float-right fa-2x golden-star"></i>
                {% endfor %}
            </div>
            <div class="card-reveal">
                <span class="card-title grey-text text-darken-4">{{ restaurant.name }}<i
                        class="fas fa-times close-reveal"></i></span>
                {% if restaurant.reviews %}
                {% for review in restaurant.reviews %}
                <p>{{ review.description }}</p>
                {% for i in range(1, review.star_score|int) %}
                <i class="fas fa-star golden-star"></i>
                {% endfor %}
                {% endfor %}
                {% else %}
                <p>Leave Review</p>
                {% endif %}
            </div>


        </div>
    </div>
    {% endfor %}
</div>


{% endblock %}